<% peerings = YAML.load_file(@gre_yaml); -%>
<% peerings.each_pair do |gretun,node| -%>
<% @peers.each do |tunnel,pref| -%>
<% if gretun == tunnel -%>

protocol bgp i_<%= tunnel.gsub('-', '_') %> from ibgp {
    source address <%= node['ipv6src'] %>;
    neighbor <%= node['ipv6dst'] %> as <%= @our_as %>;
    default bgp_local_pref <%= pref %>;
<% if @next_hop_self != "" -%>    next hop self;
}
<% end -%>
<% end -%>
<% end -%>
